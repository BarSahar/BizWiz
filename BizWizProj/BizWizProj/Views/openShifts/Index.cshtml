<script src="@Url.Content("~/Scripts/DayPilot/daypilot-all.min.js")" type="text/javascript"></script>
<br />
<br />
<br />
<br />

<div id="dp">
    @Html.DayPilotCalendar("dp", new DayPilot.Web.Mvc.DayPilotCalendarConfig
{
    BackendUrl = Url.Action("Backend", "OpenShifts"),
    ViewType = DayPilot.Web.Mvc.Enums.Calendar.ViewType.Week,
    TimeFormat = DayPilot.Web.Mvc.Enums.TimeFormat.Clock24Hours,

    //EventClickHandling = DayPilot.Web.Mvc.Events.Calendar.EventClickHandlingType.JavaScript,
    //EventClickJavaScript = "editEvent(e.value())",
    //    OnEventRightClick
    //EventSelectHandling
    //EventSelectColor
    //EventClickHandling = DayPilot.Web.Mvc.Events.Calendar.EventClickHandlingType.JavaScript,
    //EventClickJavaScript = "editEvent(e.value());"
    
})
</div>
<br />
@using (Html.BeginForm("OpenToClose", "OpenShifts"))
{
    <input type="submit" value="Close Shift" class="btn btn-default" />
}

@using (Html.BeginForm("SendShift", "OpenShifts"))
{
    <label for="shiftID">shiftID:</label>
    <input type="text" name="shiftID" />
    <br />
    <label for="senderID">senderID:</label>
    <input type="text" name="senderID" />
    <br />
    <label for="preference">preference:</label>
    <input type="text" name="preference" />
    <br />

    <input type="submit" value="Close Shift" class="btn btn-default" />
}



<script type="text/javascript">
    dp.commandCallBack('nextWeek'); //Setting the Shift in progress to always be in next Week
    

    dp.contextMenu = new DayPilot.Menu({
        items: [
            {
                text: "Want", onclick: function (args) {
                    debugger;
                    Post(this.source.value(), 1)
                    this.source.data.backColor = "green";
                    dp.events.update(this.source);
                }
            },
            { text: "-" },
            {
                text: "Don't Care", onclick: function (args) {
                    this.source.data.backColor = "blue";
                    Post(this.source.value(), 2)
                    dp.events.update(this.source);
                }
            },
            { text: "-" },
            {
                text: "Don't Want", onclick: function (args) {
                    this.source.data.backColor = "red";
                    Post(this.source.value(), 3)
                    dp.events.update(this.source);
                }
            },
            {
                text: "Refresh", onclick: function (args) {
                    debugger;
                    dp.events.update(this.source);
                }
            },
        ]

    });


    function Post(shiftID,pref) {

        $.post("OpenShifts/SendShift",
        {
            shiftID: shiftID,
            preference:pref
        })
    }

    function select(e) {
        var m = new DayPilot.Modal();
        m.closed = function () {
            if (this.result == "OK") {
                dp.commandCallBack('refresh');
            }
            dp.clearSelection();
        };
        m.showUrl('@Url.Action("Edit", "OpenShifts")');
    }

</script>
